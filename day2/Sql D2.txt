/////////////////////////////////////////////////////////////////////////////////////////////

SELECT * FROM _show ORDER BY rating DESC, name DESC LIMIT 3, 3;

/////////////////////////////////////////////////////////////////////////////////////////////

SELECT * FROM _show WHERE name LIKE "g%" and name NOT LIKE "%ame of thrones";

/////////////////////////////////////////////////////////////////////////////////////////////

SELECT COUNT(id) FROM _show ORDER by rating DESC;

/////////////////////////////////////////////////////////////////////////////////////////////

SELECT COUNT(*),rating from _show WHERE 
	rating BETWEEN 0 and 2
    or rating BETWEEN 2 and 4
    or rating BETWEEN 4 and 6
    or rating BETWEEN 6 and 8
    or rating BETWEEN 8 and 10
    GROUP BY rating;

/////////////////////////////////////////////////////////////////////////////////////////////

SELECT * FROM _show JOIN genre_show JOIN genre ON genre_show.genre = genre.id AND genre_show._show = _show.id WHERE genre.genre ="comedy";

/////////////////////////////////////////////////////////////////////////////////////////////

DELETE * FROM _show INNER JOIN genre_show INNER JOIN genre ON genre_show.genre = genre.id AND genre_show._show = _show.id WHERE genre.genre ="drama";

/////////////////////////////////////////////////////////////////////////////////////////////

{da, daca "SET autocommit = 0" >>>> nu s-a facut commit dupa stergere}

/////////////////////////////////////////////////////////////////////////////////////////////

UPDATE _show JOIN genre_show JOIN genre ON genre_show.genre = genre.id AND genre_show._show = _show.id SET rating = rating + 1 WHERE genre.genre ="romance";

/////////////////////////////////////////////////////////////////////////////////////////////

SELECT name, nr_show FROM director WHERE nr_show > 1;

/////////////////////////////////////////////////////////////////////////////////////////////

UPDATE director SET nr_show = (SELECT COUNT(*) FROM _show WHERE director.id = _show.director);

/////////////////////////////////////////////////////////////////////////////////////////////

SELECT name FROM director ORDER BY nr_show DESC, birth_date DESC, name DESC;

/////////////////////////////////////////////////////////////////////////////////////////////

SELECT streaming_platform.name, COUNT(_show.streaming_platform) FROM streaming_platform JOIN _show ON streaming_platform.id = _show.streaming_platform GROUP BY streaming_platform.id;

/////////////////////////////////////////////////////////////////////////////////////////////

SELECT concat( "The director ", name," aged ", Round(DATEDIFF(NOW(), (SELECT _show.release_date FROM _show WHERE _show.director = director.id))/365.0) , " years since released ", (SELECT concat(_show.name , " in ", _show.release_date) FROM _show WHERE _show.director = director.id) ) as info FROM director WHERE director.birth_date > (SELECT avg(birth_date) from director) ORDER BY birth_date;

/////////////////////////////////////////////////////////////////////////////////////////////

